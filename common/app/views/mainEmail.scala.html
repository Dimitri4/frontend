@(metaData: model.Page)(head: Html)(body: Html)(implicit request: RequestHeader)

@import conf.switches.Switches._
@import common.InlineJs
@import templates.inlineJS.blocking.js._

<!doctype html>
<head>
    @if(play.Play.isDev() || !InlineCriticalCss.isSwitchedOn) {
        <link rel="stylesheet" type="text/css" href="@Static("stylesheets/head.email.css")" />
    } else {
        <style class="js-loggable">
        @Html(Static.css.head(Some("email")))
        </style>
    }

    @fragments.fontDefinitions()

    <script>
    @if(FontSwitch.isSwitchedOn) {
        @InlineJs(loadFonts().body, "loadFonts.js")
    }
    </script>
</head>
<html>
    <body>
        @body

        <script>
            @Html(curlConfig().body)

            @Html(Static.js.email);
console.log('outside define')
            define([
                'bootstraps/email'
            ], function (
                email
            ){
            console.log('defined')
                email.init();

                // Initalise email forms in iframes
                forEach(document.getElementsByClassName('js-email-sub__iframe'), function (el) {
                    email.init(el);
                });
            })
        </script>
    </body>
</html>
